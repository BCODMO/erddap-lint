<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="generator" content=
  "HTML Tidy for HTML5 for Linux version 5.2.0">
  <title>ERDDAP Lint Tool</title>
  <meta name="viewport" content=
  "width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/tachyons.min.css">
  <script src="js/erddap-lint.js"></script>
</head>
<body class="w-100 sans-serif">
  <header class="w-100 pa3 ph5-ns bg-white">
    <div class=
    "flex flex-wrap flex-nowrap-ns items-center mw9 center w-100">
      <div class="flex items-center w-100 w-50-ns mb2 mb0-ns">
        <a href="/" class=
        "nowrap dib f5 f4-ns fw6 mt0 mb1 link black-90" title=
        "Home">
        <h1>Welcome to the ERDDAP Lint Tool</h1>
        <div class="dib">
          <small class=
          "nowrap f7 mt2 mt3-ns pr2 black-70">v0.0.1</small>
        </div></a>
      </div>
    </div>
  </header>
  <main class="w-100 bt b--black-10 bg-white">
    <section class="bg-black-0125 w-100">
      <article class="pb4">
        <header class=
        "ph3 ph5-ns w-100 bg-transparent pv3 bb b--black-10 overflow-auto">
          <div class="nowrap mw9 center">
            <a title="Getting Started" href="#getting-started"
            class=
            "pv1-ns f6 fw6 dim link black-70 mr2 mr3-m mr4-l dib">Home</a> 
            <a title="Home" href="#home"
            class=
            "pv1-ns f6 fw6 dim link black-70 mr1 mr3-m mr4-l dib">About</a>
          </div>
        </header>
      </article>
    <article class="pb4" id="about">
      <div class="nowrap mw7 center">
  <div class="measure">
    <label for="dataset-url" class="f6 b db mb2">Dataset metadata URL</label>
    <input id="dataset-url" class="input-reset ba b--black-20 pa2 mb2 db w-100" type="text"
    aria-describedby="dataset-url-desc" value="https://erddap.marine.ie/erddap/info/ais_met_hydro/index.json">
    <small id="dataset-url-desc" class="f6 black-60 db mb2">URL to the ERDDAP dataset metadata page.</small>
  </div>

  <button id="validate-button" class="f6 link dim br3 ph3 pv2 mb2 dib black bg-mid-green">Validate</button>
</div>
<pre id="report">












</pre>
    </article>
    </section>
  </main>
  <footer class="pv4 ph3 ph5-m ph6-l mid-gray" id="about">
  <small class="f6 db tc">Â© 2020 <b class="ttu">Irish Marine Institute</b></small>
  <div class="tc mt3">
    <a href="https://coastwatch.pfeg.noaa.gov/erddap/index.html" title="Language" class="f6 dib ph2 link mid-gray dim">ERDDAP</a>
    <a href="https://www.marine.ie/"    title="Terms" class="f6 dib ph2 link mid-gray dim">Irish Marine Institute</a>
    <a href="https://github.com/IrishMarineInstitute/erddap-lint"  title="Fork Me" class="f6 dib ph2 link mid-gray dim">ERDDAP-Lint</a>
  </div>
</footer>
<script>
  let t = new Date().getTime();
  fetch("rules/index.html").then(r=>r.text()).then(html=>{
    let el = document.createElement("div");
    el.innerHTML = html;
    let ruleUrls = Array.prototype.map.call(el.querySelectorAll("A"), 
        (e)=> e.getAttribute('href')).map(url=>new URL(`rules/${url}?${t}`,document.baseURI).href);
    let linter = new ErddapLint();
    linter.fetchRules(ruleUrls).then(()=>{
      let report = document.getElementById("report");
      document.getElementById("validate-button").addEventListener("click",()=>{
        let datasetURL = document.getElementById("dataset-url").value;
        linter.fetchDataset(datasetURL).then(dataset=>{
          report.innerText = "";
          let context = {
            log: (text)=>report.innerText = report.innerText+text+"\n"
          }
          linter.applyRules(dataset,context);
        });
      });
    });
  });
  
</script>
</body>
</html>
